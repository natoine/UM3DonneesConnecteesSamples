<!DOCTYPE html>
<html lang="fr">
	<head>
	  <meta charset="utf-8">
		<title>Tests Fetch</title>
		<meta descr="testez des requêtes">
	</head>
	<body>
		<div class="container">
				<div class="row-fluid">
					<div class="span12">
						<h1 class="text-center">Testez vos requêtes</h1>
					</div>
				</div>

				<div class="row-fluid">
					<div class="span4 offset4">
					<form>
			  			<fieldset>
			    			<label>token</label>
			    			<input type="text" placeholder="token ?" id="token">
			    			<input type="text" placeholder="latitude" id="latitude">
			    			<input type="text" placeholder="longitude" id="longitude">
			    			<button type="button" class="btn btn-primary btn-large btn-block" id="tokenSend">Envoi de la requête</button>
			  			</fieldset>
					</form>
					</div>

					<div>
						<h1 class="text-center">Résultat de la requête</h1>
						<div id="resultQuery">
						</div>
					</div>
				</div>
		</div>	

		<script>
			document.addEventListener('DOMContentLoaded', () => {
				document.querySelector("#tokenSend").addEventListener("click", testToken)

				function testToken() 
				{
					console.log("value token: " + document.querySelector("#token").value)
					var token = document.querySelector("#token").value
					var lat = document.querySelector("#latitude").value
					var long = document.querySelector("#longitude").value

					var url = 'http://api.openweathermap.org/data/2.5/weather?lat='+lat+'&lon='+long+'&APPID='+ token
					console.log("url : " + url)
					fetch(url).then(
						function(response){
							response.json().then(function(data){
								document.querySelector("#resultQuery").innerHTML = "weather is " + data.weather[0].main + " température °F: " + data.main.temp + " vitesse du vent : " + data.wind.speed
							})
	 					}
 					)
				}
			})
		</script>
		
	</body>
</html>